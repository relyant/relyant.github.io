<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title | default: "Sailing Kiruna" }}</title>
    <link rel="icon" type="image/png" href="{{ site.baseurl }}/logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --primary-color: #2196F3;
            --primary-dark: #1976D2;
            --secondary-color: #FF9800;
            --background-color: #121212;
            --surface-color: #1E1E1E;
            --text-primary: #FFFFFF;
            --text-secondary: #B3B3B3;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Light Mode Variables */
        [data-theme="light"] {
            --background-color: #87CEEB;
            --surface-color: rgba(255, 255, 255, 0.9);
            --text-primary: #212121;
            --text-secondary: #757575;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: var(--background-color);
            color: var(--text-primary);
            transition: var(--transition);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
        }

        /* --- COLORFUL HOVER EFFECTS --- */
        /* Takes generic List Items (li) or elements with class 'post-entry' */
        ul li, .post-entry {
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 4px;
            transition: transform 0.2s, box-shadow 0.2s, border-left-color 0.2s;
            border-left: 5px solid transparent; /* Hidden border by default */
            list-style: none;
        }

        /* 1. Purple */
        ul li:nth-child(6n+1):hover, .post-entry:nth-child(6n+1):hover { 
            border-left-color: #4b3c6d; 
            box-shadow: 0 4px 15px -5px #4b3c6d;
            background: rgba(75, 60, 109, 0.1); 
            transform: translateX(8px);
        }

        /* 2. Light Blue */
        ul li:nth-child(6n+2):hover, .post-entry:nth-child(6n+2):hover { 
            border-left-color: #068ab8; 
            box-shadow: 0 4px 15px -5px #068ab8; 
            background: rgba(6, 138, 184, 0.1);
            transform: translateX(8px);
        }

        /* 3. Dark Blue */
        ul li:nth-child(6n+3):hover, .post-entry:nth-child(6n+3):hover { 
            border-left-color: #046886; 
            box-shadow: 0 4px 15px -5px #046886; 
            background: rgba(4, 104, 134, 0.1);
            transform: translateX(8px);
        }

        /* 4. Green */
        ul li:nth-child(6n+4):hover, .post-entry:nth-child(6n+4):hover { 
            border-left-color: #a5c048; 
            box-shadow: 0 4px 15px -5px #a5c048; 
            background: rgba(165, 192, 72, 0.1);
            transform: translateX(8px);
        }

        /* 5. Orange */
        ul li:nth-child(6n+5):hover, .post-entry:nth-child(6n+5):hover { 
            border-left-color: #f77102; 
            box-shadow: 0 4px 15px -5px #f77102; 
            background: rgba(247, 113, 2, 0.1);
            transform: translateX(8px);
        }

        /* 6. Red */
        ul li:nth-child(6n+6):hover, .post-entry:nth-child(6n+6):hover { 
            border-left-color: #cb1025; 
            box-shadow: 0 4px 15px -5px #cb1025; 
            background: rgba(203, 16, 37, 0.1);
            transform: translateX(8px);
        }

        /* Star Animation / Theme Styles */
        .stars { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; }
        .star { position: absolute; width: 2px; height: 2px; background: white; border-radius: 50%; opacity: 0.8; transition: var(--transition); }
        .star.bright { width: 3px; height: 3px; box-shadow: 0 0 4px white; opacity: 1; }
        .constellation-line { position: absolute; height: 1px; background: rgba(255, 255, 255, 0.2); transform-origin: 0 0; pointer-events: none; }
        
        .container {
            width: 100%;
            max-width: 800px;
            background: var(--surface-color);
            padding: 40px;
            border-radius: 20px;
            box-shadow: var(--shadow);
            z-index: 1;
            position: relative;
        }
        
        /* Toggle Button */
        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            transition: var(--transition);
        }
        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--primary-color);
        }

        /* Make links inherit color so they don't clash with hover */
        a { text-decoration: none; color: inherit; display: block; }
    </style>
</head>
<body id="body">
    <div id="stars" class="stars"></div>
    
    <div class="container">
        <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
            <span class="material-icons" id="themeIcon">dark_mode</span>
        </button>
        
        {{ content }}
    </div>

    <script>
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const body = document.getElementById('body');
        const starsContainer = document.getElementById('stars');

        // 1. Check Local Storage first
        const savedTheme = localStorage.getItem('theme');
        
        // 2. Check System Preference second
        const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        // 3. Determine initial theme
        let currentTheme;
        if (savedTheme) {
            currentTheme = savedTheme;
        } else {
            currentTheme = systemPrefersDark ? 'dark' : 'light';
        }

        // Apply theme on load
        applyTheme(currentTheme);

        function applyTheme(theme) {
            body.setAttribute('data-theme', theme);
            themeIcon.textContent = theme === 'dark' ? 'light_mode' : 'dark_mode';
            
            // Handle stars
            if (theme === 'dark') {
                generateStars();
            } else {
                if (starsContainer) starsContainer.innerHTML = ''; // clear stars in light mode
            }
        }

        // Toggle Event Listener
        themeToggle.addEventListener('click', () => {
            const isDark = body.getAttribute('data-theme') === 'dark';
            const newTheme = isDark ? 'light' : 'dark';
            
            applyTheme(newTheme);
            localStorage.setItem('theme', newTheme);
        });

        // Star Logic
        function generateStars() {
            if (!starsContainer) return;
            starsContainer.innerHTML = '';
            
            // Safety check
            if(body.getAttribute('data-theme') !== 'dark') return;

            const numStars = 150;
            const stars = [];
            for (let i = 0; i < numStars; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                const x = Math.random() * window.innerWidth;
                const y = Math.random() * window.innerHeight;
                star.style.left = x + 'px';
                star.style.top = y + 'px';
                if (Math.random() > 0.8) star.classList.add('bright');
                stars.push({ element: star, x, y });
                starsContainer.appendChild(star);
            }
            
            let mouseX = 0;
            let mouseY = 0;
            
            // Clean up old listener if exists to prevent duplicates (optional optimization)
            // For simplicity, we add the listener but perform checks inside
            document.addEventListener('mousemove', (e) => {
                if (body.getAttribute('data-theme') !== 'dark') {
                    document.querySelectorAll('.constellation-line').forEach(line => line.remove());
                    return;
                }
                
                mouseX = e.clientX;
                mouseY = e.clientY;
                document.querySelectorAll('.constellation-line').forEach(line => line.remove());
                stars.forEach(star => {
                    const distance = Math.sqrt(Math.pow(mouseX - star.x, 2) + Math.pow(mouseY - star.y, 2));
                    if (distance < 150) {
                        const line = document.createElement('div');
                        line.className = 'constellation-line';
                        const angle = Math.atan2(mouseY - star.y, mouseX - star.x) * 180 / Math.PI;
                        const length = distance;
                        line.style.left = star.x + 'px';
                        line.style.top = star.y + 'px';
                        line.style.width = length + 'px';
                        line.style.transform = `rotate(${angle}deg)`;
                        line.style.opacity = (1 - distance / 150) * 0.6;
                        starsContainer.appendChild(line);
                    }
                });
            });
        }

        window.addEventListener('resize', () => {
            if (body.getAttribute('data-theme') === 'dark') { generateStars(); }
        });
    </script>
</body>
</html>
