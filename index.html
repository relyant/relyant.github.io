---
layout: default
title: Sailing Kiruna
---

<div class="profile-image">
    <img src="{{ site.baseurl }}/logo.png" alt="Profile">
</div>

<h1>Sailing Kiruna</h1>
<div class="subtitle">  Begleite mich auf meiner Ovni 43
  <a href="/specs/" style="text-decoration: none; color: inherit;">Kiruna</a>
</div>

<!-- ========================= MAP WIDGET START ========================= -->
<!-- Container styled like a blog-row to match the glass theme -->
<div class="blog-row" style="display: block; padding: 0; overflow: hidden; height: auto;">
    
    <!-- Map Container -->
    <div id="vessel-map" style="height: 300px; width: 100%; z-index: 1;"></div>
    
    <!-- Info Bar below map -->
    <div style="padding: 15px; display: flex; justify-content: space-between; align-items: center; background: rgba(0,0,0,0.2);">
        <div style="display: flex; align-items: center; gap: 8px;">
            <span class="material-icons" style="font-size: 18px; color: var(--primary-color);">place</span>
            <span id="location-name" style="font-weight: 500;">Lade Position...</span>
        </div>
        <div style="font-size: 0.85rem; opacity: 0.8;">
            <span class="material-icons" style="font-size: 14px; vertical-align: middle;">schedule</span>
            Aktualisiert: <span id="last-updated">--</span>
        </div>
    </div>
</div>

<!-- Leaflet CSS & JS (Loaded only on homepage) -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        
        // --- CONFIGURATION ---
        const TILES_LIGHT = 'https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png'; 
        const TILES_DARK  = 'https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png';
        const DATA_FILE   = '{{ site.baseurl }}/location.json';

        // --- MAP INIT ---
        const map = L.map('vessel-map', {
            zoomControl: false,       
            scrollWheelZoom: false,   
            dragging: false,          
            attributionControl: false 
        }).setView([0, 0], 2);

        // Initialize Tile Layer
        let currentTileLayer = L.tileLayer('', {
            maxZoom: 20,
            subdomains: 'abcd'
        }).addTo(map);

        // --- THEME LOGIC (SYNC WITH DEFAULT.HTML) ---
        function setMapTheme() {
            // Check the data-theme attribute on the BODY tag (set by default.html)
            const currentTheme = document.body.getAttribute('data-theme');
            // If theme is 'light', use light tiles, otherwise assume dark
            const newUrl = (currentTheme === 'light') ? TILES_LIGHT : TILES_DARK;
            currentTileLayer.setUrl(newUrl);
        }

        // 1. Set initial theme
        setMapTheme();

        // 2. Watch for changes to the body class (MutationObserver)
        // This detects when you click the toggle button in default.html
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.type === "attributes" && mutation.attributeName === "data-theme") {
                    setMapTheme();
                }
            });
        });

        observer.observe(document.body, {
            attributes: true // Configure it to listen to attribute changes
        });


        // --- FETCH DATA ---
        fetch(DATA_FILE)
            .then(response => {
                if (!response.ok) throw new Error("File not found");
                return response.json();
            })
            .then(data => {
                const lat = data.lat;
                const lng = data.lng;
                
                // Set View (Zoom 6 is good for "Which country am I in?")
                map.setView([lat, lng], 6);

                const boatIcon = L.divIcon({
                    className: 'boat-pin',
                    html: '<span class="material-icons" style="color: #FF5252; font-size: 32px; text-shadow: 0 2px 5px rgba(0,0,0,0.5);">my_location</span>',
                    iconSize: [32, 32],
                    iconAnchor: [16, 28] 
                });

                L.marker([lat, lng], {icon: boatIcon}).addTo(map);

                document.getElementById('location-name').innerText = data.location;
                document.getElementById('last-updated').innerText = data.date;

                // --- CLICK EVENT (OSM) ---
                document.getElementById('vessel-map').addEventListener('click', function() {
                    const zoomLevel = 12;
                    const osmUrl = `https://www.openstreetmap.org/?mlat=${lat}&mlon=${lng}#map=${zoomLevel}/${lat}/${lng}`;
                    window.open(osmUrl, '_blank');
                });
            })
            .catch(err => {
                console.error('Error loading location:', err);
                document.getElementById('location-name').innerText = "Vessel location unavailable";
            });
    });
</script>
<!-- ========================= MAP WIDGET END ========================= -->


<!-- Fully Corrected Blog Section -->
<div class="blog-list">
    <h3 style="margin-bottom: 20px; margin-top: 20px; text-align: left; margin-left:10px;">Logbuch</h3>
    
    {% assign all_posts = site.posts | concat: site.journal | sort: 'date' | reverse %}

    {% for post in all_posts %}
    <a href="{{ post.url | relative_url }}" class="blog-row">
        
        <!-- Lazy Load Image Logic -->
        {% if post.image %}
            <img src="{{ post.image }}" alt="{{ post.title }}" class="blog-thumb" loading="lazy" decoding="async">
        {% else %}
            <!-- Fallback if no image exists -->
            <div class="blog-thumb" style="background: #333; display:flex; align-items:center; justify-content:center;">
                <span class="material-icons" style="color: #fff;">sailing</span>
            </div>
        {% endif %}

        <div class="blog-details">
            <span class="blog-date">
                {% assign m = post.date | date: "%-m" %}
                {{ post.date | date: "%d" }}. 
                {% case m %}
                  {% when '1' %}Januar
                  {% when '2' %}Februar
                  {% when '3' %}MÃ¤rz
                  {% when '4' %}April
                  {% when '5' %}Mai
                  {% when '6' %}Juni
                  {% when '7' %}Juli
                  {% when '8' %}August
                  {% when '9' %}September
                  {% when '10' %}Oktober
                  {% when '11' %}November
                  {% when '12' %}Dezember
                {% endcase %} 
                {{ post.date | date: "%Y" }}
            </span>
            <h4 class="blog-title">{{ post.title }}</h4>
        </div>
    </a>
    {% endfor %}
</div>


<div class="contact-info" style="margin-top: 40px;">
    <a href="mailto:kiruna@schelbert.ml" class="contact-item">
        <span class="material-icons">email</span>
        <span>Email</span> 
    </a>
    <a href="https://github.com/relyant/relyant.github.io" class="contact-item">
        <span class="material-icons">code</span>
        <span>Github</span> 
    </a>
    <a href="https://instagram.com/kiruna_sail" class="contact-item">
        <span class="material-icons">photo_camera</span>
         <span>Instagram</span>
    </a>
</div>
